<!DOCTYPE html>

<html>
    <head>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
    </head>
    <body>
        <script src="https://unpkg.com/tone@13.8.25/build/Tone.js"></script>
            
        <button type="button" id="buttonC">C</button>
        <button type="button" id="buttonD">D</button>
        <button type="button" id="buttonE">E</button>
        <button type="button" id="buttonF">F</button>
        <button type="button" id="buttonG">G</button>
        <button type="button" id="buttonA">A</button>
        <button type="button" id="buttonH">H</button>
        <button type="button" id="buttonC5">C</button>

<br>
<div class="slidecontainer">
  <p>Volume:</p>
  <input type="range" min="0" max="1" value="0.5" step="0.01" class="slider" id="volume">
  <p>Pitch:</p>
  <input type="range" min="0" max="360" value="0.5" step="0.01" class="slider" id="pitch">
  <p>Crusher:</p>
  <input type="range" min="0" max="8" value="4" step="1" class="slider" id="crusher">
  <p>Freeverb:</p>
  <input type="range" min="0" max="1" value="0.5" step="0.01" class="slider" id="freeverb">

</div>

<script >
        
let volumeslider = document.getElementById("volume");
let pitchslider = document.getElementById("pitch");
let crushslider = document.getElementById("crusher");
let freeverbslider = document.getElementById("freeverb");

const gainNode = new Tone.Gain().toMaster();

const crusher = new Tone.BitCrusher().connect(gainNode);
const freeverb = new Tone.PingPongDelay("4n", 0.2).connect(crusher);
const synth = new Tone.AMSynth().connect(freeverb);


freeverbslider.oninput = function() {
freeverb.delayTime = (this.value);
console.log(this.value);
}


crushslider.oninput = function() {
crusher.bits = (this.value);
console.log(this.value);
}


volumeslider.oninput = function() {
    gainNode.gain.value = this.value;

    console.log(this.value);
}

function pitchShift (pitch) {
  //const pitchLimit = 1;
  const intervalChange = 30;
  const points = Math.floor(pitch / intervalChange);

  if (points >= 12)
    synth.frequency.value = "C4";
  else if (points >= 11)
    synth.frequency.value = "B3";
  else if (points >= 10)
    synth.frequency.value = "A3";
  else if (points >= 9)
    synth.frequency.value = "G3";  
  else if (points >= 8)
    synth.frequency.value = "F3";
  else if (points >= 7)
    synth.frequency.value = "E3";
  else if (points >= 6)
    synth.frequency.value = "D3";
  else if (points >= 5)
    synth.frequency.value = "C3";
  else if (points >= 4)
    synth.frequency.value = "B2";
  else if (points >= 3)
    synth.frequency.value = "A2";
  else if (points >= 2)
    synth.frequency.value = "G2"; 
  else if (points >= 1)
    synth.frequency.value = "F2";
      
}

pitchslider.oninput = function() {

    pitchShift(this.value);

    console.log(this.value);
}




//play a middle 'C' for the duration of an 8th note

document.querySelector("#buttonC").addEventListener('click', function() {
    synth.triggerAttack("440");
});

document.querySelector("#buttonD").addEventListener('click', function() {
    synth.triggerRelease();
});

document.querySelector("#buttonE").addEventListener('click', function() {
    synth.triggerAttackRelease("E4", "8n");
});

document.querySelector("#buttonF").addEventListener('click', function() {
    synth.triggerAttackRelease("F4", "8n");
});

document.querySelector("#buttonG").addEventListener('click', function() {
    synth.triggerAttackRelease("G4", "8n");
});

document.querySelector("#buttonA").addEventListener('click', function() {
    synth.triggerAttackRelease("A4", "8n");
});

document.querySelector("#buttonH").addEventListener('click', function() {
    synth.triggerAttackRelease("B4", "8n");
});

document.querySelector("#buttonC5").addEventListener('click', function() {
    synth.triggerAttackRelease("C5", "8n");
});

            </script>
    </body>
</html>